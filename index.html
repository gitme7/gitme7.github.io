<!DOCTYPE html>
<html>
<head>
    <title>주소 검색</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            position: relative;
        }
        h1 {
            font-size: 3em;
            margin-bottom: 30px;
        }
        .search-container {
            display: flex;
        }
        input, button {
            margin-bottom: 10px;
        }
        input#inputAddress{
            width: 350px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 24px;
            outline: none;
            box-sizing: border-box;
        }
        button {
            padding: 10px;
            background-color: white;
            border: 0;
            border-radius: 2px;
            font-weight: 600;
            margin-left: -45px;
            outline: none;
            cursor: pointer;
        }
        #result {
            margin-top: 20px;
            text-align: center;
        }
        .credit {
            position: absolute;
            top: 15px;
            right: 25px;
            color: #999;
            font-size: 14px;
        }
    </style>
    <script>
        function searchAddress() {
            const url = "https://dapi.kakao.com/v2/local/search/address.json";
            const headers = {
                "Authorization": "KakaoAK 656e3c5e196b064eee5a2aefa400f0cf"
            };
            const query = document.getElementById("inputAddress").value;

            // 결과를 초기화합니다.
            document.getElementById("result").innerHTML = "";

            if (!query) {
                displayError("검색어를 입력해주세요.");
                return;
            }

            $.ajax({
                url: url,
                data: {query: query},
                headers: headers,
                type: "GET",
                dataType: "json",
                success: function(result) {
                    displayResult(result);
                },
                error: function(xhr, status, error) {
                    if (xhr.status == 401) {
                        displayError("API 인증이 실패하였습니다.");
                    } else {
                        displayError("검색 결과가 없습니다. 정확한 주소를 입력해주세요.");
                    }
                }
            });
        }

        function displayResult(result) {
            const documents = result.documents;
            let output = "";

            if (documents.length > 0) {
                const firstDocument = documents[0];
                const mergedAddress = firstDocument.road_address.address_name + " (" + firstDocument.address.address_name + ")";
                output = `
                    <p>주소: ${mergedAddress}</p>
                    <p>위도(y): <span id="latitude">${firstDocument.address.y}</span> <button onClick="copyToClipboard('latitude')">복사</button></p>
                    <p>경도(x): <span id="longitude">${firstDocument.address.x}</span> <button onClick="copyToClipboard('longitude')">복사</button></p>
                `;
            } else {
                output = "<p>검색 결과가 없습니다. 정확한 주소를 입력해주세요.</p>";
            }

            document.getElementById("result").innerHTML = output;
        }

        function displayError(errorMessage) {
            document.getElementById("result").innerHTML = `<p>${errorMessage}</p>`;
        }

        function copyToClipboard(elementId) {
            const el = document.createElement('textarea');
            el.value = document.getElementById(elementId).innerText;
            el.setAttribute('readonly', '');
            el.style = {position: 'absolute', left: '-9999px'};
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);

            alert('클립보드에 복사되었습니다.');
        }
    </script>
</head>
<body>
    <h1>좌표값 변환</h1>
    <div class="search-container">
        <input type="text" id="inputAddress" placeholder="주소 입력" onkeydown="if(event.key==='Enter'){searchAddress()}">
        <button onclick="searchAddress()">주소 검색</button>
    </div>
    <div id="result"></div>
    <p class="credit">부경대학교 냉동공조공학과 자동제어연구실 캡스톤디자인</p>
</body>
</html>
